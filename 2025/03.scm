(define (string->battery-bank s)
  (list->vector (map digit-value (string->list s))))

;;   '(2  3   4    2     3      4       2        3        4        2        3        4        2        7        8)
;;    ------------------------------------------------------------------------------------------------------------
;; 1 '(2  3   4    4     4      4       4        4        4        4        4        4        4        7        8)
;; 2 '(  23  34   42    43     44      44       44       44       44       44       44       44       47       78)
;; 3 '(     234  342   423    434     442      443      444      444      444      444      444      447      478)
;; 4 '(         2342  3423   4234    4342     4423     4434     4442     4443     4444     4444     4447     4478)
;; 5 '(              23423  34234   42342    43423    44234    44342    44423    44434    44442    44447    44478)
;; 6 '(                    234234  342342   423423   434234   442342   443423   444234   444342   444427   444478)
;; 7 '(                           2342342  3423423  4234234  4342342  4423423  4434234  4442342  4443427  4444278)
;; 8 '(                                   23423423 34234234 42342342 43423423 44234234 44342342 44423427 44434278)

(define (largest-joltage n banks)
  (define (loop prev left m)
    (if (= m n) (last prev)
        (let ((next
               (reverse
                (fold
                 (lambda (prev-x left-x ans)
                   (let ((next-x (+ (* prev-x 10) left-x)))
                     (if (or (null? ans) (> next-x (car ans)))
                         (cons next-x ans)
                         (cons (car ans) ans))))
                 '() prev left))))
          (loop next (cdr left) (+ m 1)))))
  (loop (circular-list 0) banks 0))
